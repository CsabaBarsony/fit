(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/** @jsx React.DOM */

var Router = window.ReactRouter;
var DefaultRoute = Router.DefaultRoute;
var NotFoundRoute = Router.NotFoundRoute;
var Link = Router.Link;
var Route = Router.Route;
var RouteHandler = Router.RouteHandler;
var Home = require("./components/home");
var Exercises = require("./components/exercises");
var Workout= require("./components/workout");
var NotFound = require("./components/not_found");
var auth = require("./helpers/auth");

var App = React.createClass({displayName: "App",
	getInitialState: function(){
		return { auth: "authorizing" };
	},
	componentDidMount: function(){
		var that = this;
		auth.authorize(function(result){
			if(result) that.setState({ auth: "authorized" });
			else window.location.href = auth.loginPage;
		});
	},
	logout: function(){
		this.setState({ auth: "loggingOut" });
		auth.logout(function(){
			window.location.href = auth.loginPage;
		});
	},
	render: function () {
		if(this.state.auth === "authorizing") return React.createElement("h1", null, "Authorizing...");
		else if(this.state.auth === "loggingOut") return React.createElement("h1", null, "Logging out...")
		else if(this.state.auth === "authorized"){
			return (
				React.createElement("div", null, 
					React.createElement("header", null, 
						React.createElement("ul", null, 
							React.createElement("li", null, React.createElement(Link, {to: "home"}, "Home")), 
							React.createElement("li", null, React.createElement(Link, {to: "exercises"}, "Exercises")), 
							React.createElement("li", null, React.createElement(Link, {to: "workout"}, "New Workout")), 
							React.createElement("li", null, 
								React.createElement("a", {href: "#", onClick: this.logout}, "Logout")
							)
						), 
						React.createElement("div", null, 
							React.createElement("p", null, "user: ", auth.getUsername())
						)
					), 
					React.createElement(RouteHandler, null)
				)
			);
		}
	}
});

var routes = (
	React.createElement(Route, {name: "home", path: "/", handler: App}, 
		React.createElement(Route, {name: "exercises", handler: Exercises}), 
		React.createElement(Route, {name: "workout", handler: Workout}), 
		React.createElement(DefaultRoute, {handler: Home}), 
		React.createElement(NotFoundRoute, {handler: NotFound})
	)
);

Router.run(routes, function(Handler) {
	React.render(React.createElement(Handler, null), document.body);
});


},{"./components/exercises":3,"./components/home":4,"./components/not_found":5,"./components/workout":6,"./helpers/auth":8}],2:[function(require,module,exports){
/** @jsx React.DOM */

var ExerciseForWorkout = React.createClass({displayName: "ExerciseForWorkout",
	remove: function(){
		this.props.remove(this.props.exerciseKey);
	},
	render: function(){
		var exercise = this.props.exercise;
		return (
			React.createElement("div", null, 
				React.createElement("span", null, exercise.name, " ", exercise.weight, " kg"), React.createElement("button", {onClick: this.remove}, "remove")
			)
		);
	}
});

module.exports = ExerciseForWorkout;

},{}],3:[function(require,module,exports){
/** @jsx React.DOM */

var api = require("../helpers/api");

var Exercises = React.createClass({displayName: "Exercises",
	getInitialState: function(){
		return {
			state: "loading_exercises",
			exercises: []
		}
	},
	componentDidMount: function(){
		api.get("/exercises", function(exercises){
			console.log(exercises);
		});
	},
	render: function(){
		return (
			React.createElement("h2", null, "Exercises")
		);
	}
});

module.exports = Exercises;

},{"../helpers/api":7}],4:[function(require,module,exports){
/** @jsx React.DOM */

var api = require("../helpers/api");

var Home = React.createClass({displayName: "Home",
	testGet: function(){
		api.get("/secret", function(result){
			console.log("get working", result);
		});
	},
	testPost: function(){
		api.post("/secret", { testData: "majom" }, function(result){
			console.log("post working", result);
		})
	},
	render: function(){
		return (
			React.createElement("div", null, 
				React.createElement("h2", null, "Home"), 
				React.createElement("button", {type: "text", onClick: this.testGet}, "Get"), 
				React.createElement("button", {type: "text", onClick: this.testPost}, "Post")
			)
		);
	}
});

module.exports = Home;


},{"../helpers/api":7}],5:[function(require,module,exports){
/** @jsx React.DOM */

var NotFound = React.createClass({displayName: "NotFound",
	render: function(){
		return (
			React.createElement("div", null, "Page is not found")
		);
	}
});

module.exports = NotFound;

},{}],6:[function(require,module,exports){
/** @jsx React.DOM */

var api = require("../helpers/api");
var ExerciseForWorkout = require("./exerciseForWorkout");

var Workout = React.createClass({displayName: "Workout",
	getInitialState: function(){
		return {
			exercises: null,
			selectedExercise: null,
			exerciseForWorkoutList: []
		};
	},
	componentDidMount: function(){
		var that = this;
		api.get("/exercises", function(exercises){
			that.setState({
				exercises: exercises,
				selectedExercise: exercises[0]
			});
		});
	},
	addExercise: function(){
		var weight = prompt("Weight? (kg)", 0);
		var sets = prompt("Number of sets?", 1);
		var selectedExerciseList = [];
		for(var i = 0; i < sets; i++){
			selectedExerciseList.push({
				name: this.state.selectedExercise,
				weight: weight
			});
		}
		var newState = React.addons.update(this.state, {
			exerciseForWorkoutList: {
				$push: selectedExerciseList
			}
		});
		this.setState(newState);
	},
	changeExercise: function(event){
		this.setState({
			exercises: this.state.exercises,
			selectedExercise: event.target.value
		});
	},
	removeExerciseFromWorkout: function(key){
		console.log("key", key);
		var newState = React.addons.update(this.state, {
			exerciseForWorkoutList: {
				$splice: [[key, 1]]
			}
		});
		this.setState(newState);
	},
	render: function(){
		if(this.state.exercises){
			var exerciseOptions = [],
				key = 0;
			_.each(this.state.exercises, function(exercise){
				var option = (
					React.createElement("option", {key: Math.random(), value: exercise}, exercise)
				);
				exerciseOptions.push(option);
			});
			var that = this;
			var exerciseForWorkoutList = [];
			_.each(this.state.exerciseForWorkoutList, function(exercise){
				// The sequence of the 'key' and 'exerciseKey' properties is important because of the incrementation
				var element = (
					React.createElement(ExerciseForWorkout, {key: key, exerciseKey: key++, exercise: exercise, remove: that.removeExerciseFromWorkout})
				);
				exerciseForWorkoutList.push(element);
			});
			return (
				React.createElement("div", null, 
					React.createElement("h2", null, "New Workout"), 
					React.createElement("div", null, this.state.selectedExercise), 
					React.createElement("select", {onChange: this.changeExercise}, 
						exerciseOptions
					), 
					React.createElement("button", {onClick: this.addExercise}, "Add exercise"), 
					exerciseForWorkoutList
				)
			);
		}
		else{
			return (
				React.createElement("h2", null, "Loading...")
			);
		}
	}
});

module.exports = Workout;

},{"../helpers/api":7,"./exerciseForWorkout":2}],7:[function(require,module,exports){
var auth = require("./auth");

module.exports = {
	log: function(text){
		console.log(text);
	},
	get: function(url, success){
		$.ajax({
			url: url,
			type: 'GET',
			headers: {
				"x-auth-token": auth.getToken(),
				"x-auth-username": auth.getUsername()
			},
			success: function(result) {
				success(result);
			}.bind(this),
			error: function(xhr, status, err) {
				console.log(status);
				if(xhr.status >= 400) window.location.href = auth.loginPage;
			}.bind(this)
		});
	},
	post: function(url, data, success){
		$.ajax({
			url: url,
			type: 'POST',
			data: data,
			headers: {
				"x-auth-token": auth.getToken(),
				"x-auth-username": auth.getUsername()
			},
			success: function(result) {
				success(result);
			}.bind(this),
			error: function(xhr, status, err) {
				console.log(status);
				if(xhr.status >= 400) window.location.href = auth.loginPage;
			}.bind(this)
		});
	}
};

},{"./auth":8}],8:[function(require,module,exports){
var auth = {
	loginPage: "/login.html",
	logout: function(callback){
		$.ajax({
			url: "/logout",
			type: 'POST',
			data: {
				username: this.getUsername()
			},
			success: function(result) {
				delete localStorage.token;
				delete localStorage.username;
				callback();
			}.bind(this),
			error: function(xhr, status, err) {
				console.log("error while loggint out");
				delete localStorage.token;
				delete localStorage.username;
				callback();
			}.bind(this)
		});
	},
	authorize: function(callback){
		if(!this.getToken()) {
			callback(false);
			return;
		}

		$.ajax({
			url: "/authorize",
			type: 'GET',
			headers: {
				"x-auth-token": this.getToken(),
				"x-auth-username": this.getUsername()
			},
			success: function(result) {
				callback(true);
			}.bind(this),
			error: function(xhr, status, err) {
				callback(false);
			}.bind(this)
		});
	},
	getToken: function(){
		return localStorage.token;
	},
	getUsername: function(){
		return localStorage.username;
	},
	loggedIn: function(){
		return this.getToken();
	},
	onChange: function(){}
};

module.exports = auth;

},{}]},{},[1])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlc1xcYnJvd3NlcmlmeVxcbm9kZV9tb2R1bGVzXFxicm93c2VyLXBhY2tcXF9wcmVsdWRlLmpzIiwiQzpcXGRldlxcd2ViXFxmaXRcXHNyY1xcc2NyaXB0c1xcbWFpbi5qcyIsIkM6XFxkZXZcXHdlYlxcZml0XFxzcmNcXHNjcmlwdHNcXGNvbXBvbmVudHNcXGV4ZXJjaXNlRm9yV29ya291dC5qcyIsIkM6XFxkZXZcXHdlYlxcZml0XFxzcmNcXHNjcmlwdHNcXGNvbXBvbmVudHNcXGV4ZXJjaXNlcy5qcyIsIkM6XFxkZXZcXHdlYlxcZml0XFxzcmNcXHNjcmlwdHNcXGNvbXBvbmVudHNcXGhvbWUuanMiLCJDOlxcZGV2XFx3ZWJcXGZpdFxcc3JjXFxzY3JpcHRzXFxjb21wb25lbnRzXFxub3RfZm91bmQuanMiLCJDOlxcZGV2XFx3ZWJcXGZpdFxcc3JjXFxzY3JpcHRzXFxjb21wb25lbnRzXFx3b3Jrb3V0LmpzIiwiQzpcXGRldlxcd2ViXFxmaXRcXHNyY1xcc2NyaXB0c1xcaGVscGVyc1xcYXBpLmpzIiwiQzpcXGRldlxcd2ViXFxmaXRcXHNyY1xcc2NyaXB0c1xcaGVscGVyc1xcYXV0aC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBLHFCQUFxQjs7QUFFckIsSUFBSSxNQUFNLEdBQUcsTUFBTSxDQUFDLFdBQVcsQ0FBQztBQUNoQyxJQUFJLFlBQVksR0FBRyxNQUFNLENBQUMsWUFBWSxDQUFDO0FBQ3ZDLElBQUksYUFBYSxHQUFHLE1BQU0sQ0FBQyxhQUFhLENBQUM7QUFDekMsSUFBSSxJQUFJLEdBQUcsTUFBTSxDQUFDLElBQUksQ0FBQztBQUN2QixJQUFJLEtBQUssR0FBRyxNQUFNLENBQUMsS0FBSyxDQUFDO0FBQ3pCLElBQUksWUFBWSxHQUFHLE1BQU0sQ0FBQyxZQUFZLENBQUM7QUFDdkMsSUFBSSxJQUFJLEdBQUcsT0FBTyxDQUFDLG1CQUFtQixDQUFDLENBQUM7QUFDeEMsSUFBSSxTQUFTLEdBQUcsT0FB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WTtHQUNqQixJQUFJLEVBQUUsS0FBSztHQUNYLE9BQU8sRUFBRTtJQUNSLGNBQWMsRUFBRSxJQUFJLENBQUMsUUFBUSxFQUFFO0lBQy9CLGlCQUFpQixFQUFFLElBQUksQ0FBQyxXQUFXLEVBQUU7SUFDckM7R0FDRCxPQUFPLEVBQUUsU0FBUyxNQUFNLEVBQUU7SUFDekIsUUFBUSxDQUFDLElBQUksQ0FBQyxDQUFDO0lBQ2YsQ0FBQyxJQUFJLENBQUMsSUFBSSxDQUFDO0dBQ1osS0FBSyxFQUFFLFNBQVMsR0FBRyxFQUFFLE1BQU0sRUFBRSxHQUFHLEVBQUU7SUFDakMsUUFBUSxDQUFDLEtBQUssQ0FBQyxDQUFDO0lBQ2hCLENBQUMsSUFBSSxDQUFDLElBQUksQ0FBQztHQUNaLENBQUMsQ0FBQztFQUNIO0NBQ0QsUUFBUSxFQUFFLFVBQVU7RUFDbkIsT0FBTyxZQUFZLENBQUMsS0FBSyxDQUFDO0VBQzFCO0NBQ0QsV0FBVyxFQUFFLFVBQVU7RUFDdEIsT0FBTyxZQUFZLENBQUMsUUFBUSxDQUFDO0VBQzdCO0NBQ0QsUUFBUSxFQUFFLFVBQVU7RUFDbkIsT0FBTyxJQUFJLENBQUMsUUFBUSxFQUFFLENBQUM7RUFDdkI7Q0FDRCxRQUFRLEVBQUUsVUFBVSxFQUFFO0FBQ3ZCLENBQUMsQ0FBQzs7QUFFRixNQUFNLENBQUMsT0FBTyxHQUFHLElBQUkiLCJmaWxlIjoiZ2VuZXJhdGVkLmpzIiwic291cmNlUm9vdCI6IiIsInNvdXJjZXNDb250ZW50IjpbIihmdW5jdGlvbiBlKHQsbixyKXtmdW5jdGlvbiBzKG8sdSl7aWYoIW5bb10pe2lmKCF0W29dKXt2YXIgYT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2lmKCF1JiZhKXJldHVybiBhKG8sITApO2lmKGkpcmV0dXJuIGkobywhMCk7dmFyIGY9bmV3IEVycm9yKFwiQ2Fubm90IGZpbmQgbW9kdWxlICdcIitvK1wiJ1wiKTt0aHJvdyBmLmNvZGU9XCJNT0RVTEVfTk9UX0ZPVU5EXCIsZn12YXIgbD1uW29dPXtleHBvcnRzOnt9fTt0W29dWzBdLmNhbGwobC5leHBvcnRzLGZ1bmN0aW9uKGUpe3ZhciBuPXRbb11bMV1bZV07cmV0dXJuIHMobj9uOmUpfSxsLGwuZXhwb3J0cyxlLHQsbixyKX1yZXR1cm4gbltvXS5leHBvcnRzfXZhciBpPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7Zm9yKHZhciBvPTA7bzxyLmxlbmd0aDtvKyspcyhyW29dKTtyZXR1cm4gc30pIiwiLyoqIEBqc3ggUmVhY3QuRE9NICovXHJcblxyXG52YXIgUm91dGVyID0gd2luZG93LlJlYWN0Um91dGVyO1xyXG52YXIgRGVmYXVsdFJvdXRlID0gUm91dGVyLkRlZmF1bHRSb3V0ZTtcclxudmFyIE5vdEZvdW5kUm91dGUgPSBSb3V0ZXIuTm90Rm91bmRSb3V0ZTtcclxudmFyIExpbmsgPSBSb3V0ZXIuTGluaztcclxudmFyIFJvdXRlID0gUm91dGVyLlJvdXRlO1xyXG52YXIgUm91dGVIYW5kbGVyID0gUm91dGVyLlJvdXRlSGFuZGxlcjtcclxudmFyIEhvbWUgPSByZXF1aXJlKFwiLi9jb21wb25lbnRzL2hvbWVcIik7XHJcbnZhciBFeGVyY2lzZXMgPSByZXF1aXJlKFwiLi9jb21wb25lbnRzL2V4ZXJjaXNlc1wiKTtcclxudmFyIFdvcmtvdXQ9IHJlcXVpcmUoXCIuL2NvbXBvbmVudHMvd29ya291dFwiKTtcclxudmFyIE5vdEZvdW5kID0gcmVxdWlyZShcIi4vY29tcG9uZW50cy9ub3RfZm91bmRcIik7XHJcbnZhciBhdXRoID0gcmVxdWlyZShcIi4vaGVscGVycy9hdXRoXCIpO1xyXG5cclxudmFyIEFwcCA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcclxuXHRnZXRJbml0aWFsU3RhdGU6IGZ1bmN0aW9uKCl7XHJcblx0XHRyZXR1cm4geyBhdXRoOiBcImF1dGhvcml6aW5nXCIgfTtcclxuXHR9LFxyXG5cdGNvbXBvbmVudERpZE1vdW50OiBmdW5jdGlvbigpe1xyXG5cdFx0dmFyIHRoYXQgPSB0aGlzO1xyXG5cdFx0YXV0aC5hdXRob3JpemUoZnVuY3Rpb24ocmVzdWx0KXtcclxuXHRcdFx0aWYocmVzdWx0KSB0aGF0LnNldFN0YXRlKHsgYXV0aDogXCJhdXRob3JpemVkXCIgfSk7XHJcblx0XHRcdGVsc2Ugd2luZG93LmxvY2F0aW9uLmhyZWYgPSBhdXRoLmxvZ2luUGFnZTtcclxuXHRcdH0pO1xyXG5cdH0sXHJcblx0bG9nb3V0OiBmdW5jdGlvbigpe1xyXG5cdFx0dGhpcy5zZXRTdGF0ZSh7IGF1dGg6IFwibG9nZ2luZ091dFwiIH0pO1xyXG5cdFx0YXV0aC5sb2dvdXQoZnVuY3Rpb24oKXtcclxuXHRcdFx0d2luZG93LmxvY2F0aW9uLmhyZWYgPSBhdXRoLmxvZ2luUGFnZTtcclxuXHRcdH0pO1xyXG5cdH0sXHJcblx0cmVuZGVyOiBmdW5jdGlvbiAoKSB7XHJcblx0XHRpZih0aGlzLnN0YXRlLmF1dGggPT09IFwiYXV0aG9yaXppbmdcIikgcmV0dXJuIDxoMT5BdXRob3JpemluZy4uLjwvaDE+O1xyXG5cdFx0ZWxzZSBpZih0aGlzLnN0YXRlLmF1dGggPT09IFwibG9nZ2luZ091dFwiKSByZXR1cm4gPGgxPkxvZ2dpbmcgb3V0Li4uPC9oMT5cclxuXHRcdGVsc2UgaWYodGhpcy5zdGF0ZS5hdXRoID09PSBcImF1dGhvcml6ZWRcIil7XHJcblx0XHRcdHJldHVybiAoXHJcblx0XHRcdFx0PGRpdj5cclxuXHRcdFx0XHRcdDxoZWFkZXI+XHJcblx0XHRcdFx0XHRcdDx1bD5cclxuXHRcdFx0XHRcdFx0XHQ8bGk+PExpbmsgdG89XCJob21lXCI+SG9tZTwvTGluaz48L2xpPlxyXG5cdFx0XHRcdFx0XHRcdDxsaT48TGluayB0bz1cImV4ZXJjaXNlc1wiPkV4ZXJjaXNlczwvTGluaz48L2xpPlxyXG5cdFx0XHRcdFx0XHRcdDxsaT48TGluayB0bz1cIndvcmtvdXRcIj5OZXcgV29ya291dDwvTGluaz48L2xpPlxyXG5cdFx0XHRcdFx0XHRcdDxsaT5cclxuXHRcdFx0XHRcdFx0XHRcdDxhIGhyZWY9XCIjXCIgb25DbGljaz17dGhpcy5sb2dvdXR9PkxvZ291dDwvYT5cclxuXHRcdFx0XHRcdFx0XHQ8L2xpPlxyXG5cdFx0XHRcdFx0XHQ8L3VsPlxyXG5cdFx0XHRcdFx0XHQ8ZGl2PlxyXG5cdFx0XHRcdFx0XHRcdDxwPnVzZXI6IHthdXRoLmdldFVzZXJuYW1lKCl9PC9wPlxyXG5cdFx0XHRcdFx0XHQ8L2Rpdj5cclxuXHRcdFx0XHRcdDwvaGVhZGVyPlxyXG5cdFx0XHRcdFx0PFJvdXRlSGFuZGxlci8+XHJcblx0XHRcdFx0PC9kaXY+XHJcblx0XHRcdCk7XHJcblx0XHR9XHJcblx0fVxyXG59KTtcclxuXHJcbnZhciByb3V0ZXMgPSAoXHJcblx0PFJvdXRlIG5hbWU9XCJob21lXCIgcGF0aD1cIi9cIiBoYW5kbGVyPXtBcHB9PlxyXG5cdFx0PFJvdXRlIG5hbWU9XCJleGVyY2lzZXNcIiBoYW5kbGVyPXtFeGVyY2lzZXN9Lz5cclxuXHRcdDxSb3V0ZSBuYW1lPVwid29ya291dFwiIGhhbmRsZXI9e1dvcmtvdXR9Lz5cclxuXHRcdDxEZWZhdWx0Um91dGUgaGFuZGxlcj17SG9tZX0vPlxyXG5cdFx0PE5vdEZvdW5kUm91dGUgaGFuZGxlcj17Tm90Rm91bmR9Lz5cclxuXHQ8L1JvdXRlPlxyXG4pO1xyXG5cclxuUm91dGVyLnJ1bihyb3V0ZXMsIGZ1bmN0aW9uKEhhbmRsZXIpIHtcclxuXHRSZWFjdC5yZW5kZXIoPEhhbmRsZXIvPiwgZG9jdW1lbnQuYm9keSk7XHJcbn0pO1xyXG4iLCIvKiogQGpzeCBSZWFjdC5ET00gKi9cclxuXHJcbnZhciBFeGVyY2lzZUZvcldvcmtvdXQgPSBSZWFjdC5jcmVhdGVDbGFzcyh7XHJcblx0cmVtb3ZlOiBmdW5jdGlvbigpe1xyXG5cdFx0dGhpcy5wcm9wcy5yZW1vdmUodGhpcy5wcm9wcy5leGVyY2lzZUtleSk7XHJcblx0fSxcclxuXHRyZW5kZXI6IGZ1bmN0aW9uKCl7XHJcblx0XHR2YXIgZXhlcmNpc2UgPSB0aGlzLnByb3BzLmV4ZXJjaXNlO1xyXG5cdFx0cmV0dXJuIChcclxuXHRcdFx0PGRpdj5cclxuXHRcdFx0XHQ8c3Bhbj57ZXhlcmNpc2UubmFtZX0ge2V4ZXJjaXNlLndlaWdodH0ga2c8L3NwYW4+PGJ1dHRvbiBvbkNsaWNrPXt0aGlzLnJlbW92ZX0+cmVtb3ZlPC9idXR0b24+XHJcblx0XHRcdDwvZGl2PlxyXG5cdFx0KTtcclxuXHR9XHJcbn0pO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBFeGVyY2lzZUZvcldvcmtvdXQ7IiwiLyoqIEBqc3ggUmVhY3QuRE9NICovXHJcblxyXG52YXIgYXBpID0gcmVxdWlyZShcIi4uL2hlbHBlcnMvYXBpXCIpO1xyXG5cclxudmFyIEV4ZXJjaXNlcyA9IFJlYWN0LmNyZWF0ZUNsYXNzKHtcclxuXHRnZXRJbml0aWFsU3RhdGU6IGZ1bmN0aW9uKCl7XHJcblx0XHRyZXR1cm4ge1xyXG5cdFx0XHRzdGF0ZTogXCJsb2FkaW5nX2V4ZXJjaXNlc1wiLFxyXG5cdFx0XHRleGVyY2lzZXM6IFtdXHJcblx0XHR9XHJcblx0fSxcclxuXHRjb21wb25lbnREaWRNb3VudDogZnVuY3Rpb24oKXtcclxuXHRcdGFwaS5nZXQoXCIvZXhlcmNpc2VzXCIsIGZ1bmN0aW9uKGV4ZXJjaXNlcyl7XHJcblx0XHRcdGNvbnNvbGUubG9nKGV4ZXJjaXNlcyk7XHJcblx0XHR9KTtcclxuXHR9LFxyXG5cdHJlbmRlcjogZnVuY3Rpb24oKXtcclxuXHRcdHJldHVybiAoXHJcblx0XHRcdDxoMj5FeGVyY2lzZXM8L2gyPlxyXG5cdFx0KTtcclxuXHR9XHJcbn0pO1xyXG5cclxubW9kdWxlLmV4cG9ydHMgPSBFeGVyY2lzZXM7IiwiLyoqIEBqc3ggUmVhY3QuRE9NICovXHJcblxyXG52YXIgYXBpID0gcmVxdWlyZShcIi4uL2hlbHBlcnMvYXBpXCIpO1xyXG5cclxudmFyIEhvbWUgPSBSZWFjdC5jcmVhdGVDbGFzcyh7XHJcblx0dGVzdEdldDogZnVuY3Rpb24oKXtcclxuXHRcdGFwaS5nZXQoXCIvc2VjcmV0XCIsIGZ1bmN0aW9uKHJlc3VsdCl7XHJcblx0XHRcdGNvbnNvbGUubG9nKFwiZ2V0IHdvcmtpbmdcIiwgcmVzdWx0KTtcclxuXHRcdH0pO1xyXG5cdH0sXHJcblx0dGVzdFBvc3Q6IGZ1bmN0aW9uKCl7XHJcblx0XHRhcGkucG9zdChcIi9zZWNyZXRcIiwgeyB0ZXN0RGF0YTogXCJtYWpvbVwiIH0sIGZ1bmN0aW9uKHJlc3VsdCl7XHJcblx0XHRcdGNvbnNvbGUubG9nKFwicG9zdCB3b3JraW5nXCIsIHJlc3VsdCk7XHJcblx0XHR9KVxyXG5cdH0sXHJcblx0cmVuZGVyOiBmdW5jdGlvbigpe1xyXG5cdFx0cmV0dXJuIChcclxuXHRcdFx0PGRpdj5cclxuXHRcdFx0XHQ8aDI+SG9tZTwvaDI+XHJcblx0XHRcdFx0PGJ1dHRvbiB0eXBlPVwidGV4dFwiIG9uQ2xpY2s9e3RoaXMudGVzdEdldH0+R2V0PC9idXR0b24+XHJcblx0XHRcdFx0PGJ1dHRvbiB0eXBlPVwidGV4dFwiIG9uQ2xpY2s9e3RoaXMudGVzdFBvc3R9PlBvc3Q8L2J1dHRvbj5cclxuXHRcdFx0PC9kaXY+XHJcblx0XHQpO1xyXG5cdH1cclxufSk7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IEhvbWU7XHJcbiIsIi8qKiBAanN4IFJlYWN0LkRPTSAqL1xyXG5cclxudmFyIE5vdEZvdW5kID0gUmVhY3QuY3JlYXRlQ2xhc3Moe1xyXG5cdHJlbmRlcjogZnVuY3Rpb24oKXtcclxuXHRcdHJldHVybiAoXHJcblx0XHRcdDxkaXY+UGFnZSBpcyBub3QgZm91bmQ8L2Rpdj5cclxuXHRcdCk7XHJcblx0fVxyXG59KTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gTm90Rm91bmQ7IiwiLyoqIEBqc3ggUmVhY3QuRE9NICovXHJcblxyXG52YXIgYXBpID0gcmVxdWlyZShcIi4uL2hlbHBlcnMvYXBpXCIpO1xyXG52YXIgRXhlcmNpc2VGb3JXb3Jrb3V0ID0gcmVxdWlyZShcIi4vZXhlcmNpc2VGb3JXb3Jrb3V0XCIpO1xyXG5cclxudmFyIFdvcmtvdXQgPSBSZWFjdC5jcmVhdGVDbGFzcyh7XHJcblx0Z2V0SW5pdGlhbFN0YXRlOiBmdW5jdGlvbigpe1xyXG5cdFx0cmV0dXJuIHtcclxuXHRcdFx0ZXhlcmNpc2VzOiBudWxsLFxyXG5cdFx0XHRzZWxlY3RlZEV4ZXJjaXNlOiBudWxsLFxyXG5cdFx0XHRleGVyY2lzZUZvcldvcmtvdXRMaXN0OiBbXVxyXG5cdFx0fTtcclxuXHR9LFxyXG5cdGNvbXBvbmVudERpZE1vdW50OiBmdW5jdGlvbigpe1xyXG5cdFx0dmFyIHRoYXQgPSB0aGlzO1xyXG5cdFx0YXBpLmdldChcIi9leGVyY2lzZXNcIiwgZnVuY3Rpb24oZXhlcmNpc2VzKXtcclxuXHRcdFx0dGhhdC5zZXRTdGF0ZSh7XHJcblx0XHRcdFx0ZXhlcmNpc2VzOiBleGVyY2lzZXMsXHJcblx0XHRcdFx0c2VsZWN0ZWRFeGVyY2lzZTogZXhlcmNpc2VzWzBdXHJcblx0XHRcdH0pO1xyXG5cdFx0fSk7XHJcblx0fSxcclxuXHRhZGRFeGVyY2lzZTogZnVuY3Rpb24oKXtcclxuXHRcdHZhciB3ZWlnaHQgPSBwcm9tcHQoXCJXZWlnaHQ/IChrZylcIiwgMCk7XHJcblx0XHR2YXIgc2V0cyA9IHByb21wdChcIk51bWJlciBvZiBzZXRzP1wiLCAxKTtcclxuXHRcdHZhciBzZWxlY3RlZEV4ZXJjaXNlTGlzdCA9IFtdO1xyXG5cdFx0Zm9yKHZhciBpID0gMDsgaSA8IHNldHM7IGkrKyl7XHJcblx0XHRcdHNlbGVjdGVkRXhlcmNpc2VMaXN0LnB1c2goe1xyXG5cdFx0XHRcdG5hbWU6IHRoaXMuc3RhdGUuc2VsZWN0ZWRFeGVyY2lzZSxcclxuXHRcdFx0XHR3ZWlnaHQ6IHdlaWdodFxyXG5cdFx0XHR9KTtcclxuXHRcdH1cclxuXHRcdHZhciBuZXdTdGF0ZSA9IFJlYWN0LmFkZG9ucy51cGRhdGUodGhpcy5zdGF0ZSwge1xyXG5cdFx0XHRleGVyY2lzZUZvcldvcmtvdXRMaXN0OiB7XHJcblx0XHRcdFx0JHB1c2g6IHNlbGVjdGVkRXhlcmNpc2VMaXN0XHJcblx0XHRcdH1cclxuXHRcdH0pO1xyXG5cdFx0dGhpcy5zZXRTdGF0ZShuZXdTdGF0ZSk7XHJcblx0fSxcclxuXHRjaGFuZ2VFeGVyY2lzZTogZnVuY3Rpb24oZXZlbnQpe1xyXG5cdFx0dGhpcy5zZXRTdGF0ZSh7XHJcblx0XHRcdGV4ZXJjaXNlczogdGhpcy5zdGF0ZS5leGVyY2lzZXMsXHJcblx0XHRcdHNlbGVjdGVkRXhlcmNpc2U6IGV2ZW50LnRhcmdldC52YWx1ZVxyXG5cdFx0fSk7XHJcblx0fSxcclxuXHRyZW1vdmVFeGVyY2lzZUZyb21Xb3Jrb3V0OiBmdW5jdGlvbihrZXkpe1xyXG5cdFx0Y29uc29sZS5sb2coXCJrZXlcIiwga2V5KTtcclxuXHRcdHZhciBuZXdTdGF0ZSA9IFJlYWN0LmFkZG9ucy51cGRhdGUodGhpcy5zdGF0ZSwge1xyXG5cdFx0XHRleGVyY2lzZUZvcldvcmtvdXRMaXN0OiB7XHJcblx0XHRcdFx0JHNwbGljZTogW1trZXksIDFdXVxyXG5cdFx0XHR9XHJcblx0XHR9KTtcclxuXHRcdHRoaXMuc2V0U3RhdGUobmV3U3RhdGUpO1xyXG5cdH0sXHJcblx0cmVuZGVyOiBmdW5jdGlvbigpe1xyXG5cdFx0aWYodGhpcy5zdGF0ZS5leGVyY2lzZXMpe1xyXG5cdFx0XHR2YXIgZXhlcmNpc2VPcHRpb25zID0gW10sXHJcblx0XHRcdFx0a2V5ID0gMDtcclxuXHRcdFx0Xy5lYWNoKHRoaXMuc3RhdGUuZXhlcmNpc2VzLCBmdW5jdGlvbihleGVyY2lzZSl7XHJcblx0XHRcdFx0dmFyIG9wdGlvbiA9IChcclxuXHRcdFx0XHRcdDxvcHRpb24ga2V5PXtNYXRoLnJhbmRvbSgpfSB2YWx1ZT17ZXhlcmNpc2V9PntleGVyY2lzZX08L29wdGlvbj5cclxuXHRcdFx0XHQpO1xyXG5cdFx0XHRcdGV4ZXJjaXNlT3B0aW9ucy5wdXNoKG9wdGlvbik7XHJcblx0XHRcdH0pO1xyXG5cdFx0XHR2YXIgdGhhdCA9IHRoaXM7XHJcblx0XHRcdHZhciBleGVyY2lzZUZvcldvcmtvdXRMaXN0ID0gW107XHJcblx0XHRcdF8uZWFjaCh0aGlzLnN0YXRlLmV4ZXJjaXNlRm9yV29ya291dExpc3QsIGZ1bmN0aW9uKGV4ZXJjaXNlKXtcclxuXHRcdFx0XHQvLyBUaGUgc2VxdWVuY2Ugb2YgdGhlICdrZXknIGFuZCAnZXhlcmNpc2VLZXknIHByb3BlcnRpZXMgaXMgaW1wb3J0YW50IGJlY2F1c2Ugb2YgdGhlIGluY3JlbWVudGF0aW9uXHJcblx0XHRcdFx0dmFyIGVsZW1lbnQgPSAoXHJcblx0XHRcdFx0XHQ8RXhlcmNpc2VGb3JXb3Jrb3V0IGtleT17a2V5fSBleGVyY2lzZUtleT17a2V5Kyt9IGV4ZXJjaXNlPXtleGVyY2lzZX0gcmVtb3ZlPXt0aGF0LnJlbW92ZUV4ZXJjaXNlRnJvbVdvcmtvdXR9Lz5cclxuXHRcdFx0XHQpO1xyXG5cdFx0XHRcdGV4ZXJjaXNlRm9yV29ya291dExpc3QucHVzaChlbGVtZW50KTtcclxuXHRcdFx0fSk7XHJcblx0XHRcdHJldHVybiAoXHJcblx0XHRcdFx0PGRpdj5cclxuXHRcdFx0XHRcdDxoMj5OZXcgV29ya291dDwvaDI+XHJcblx0XHRcdFx0XHQ8ZGl2Pnt0aGlzLnN0YXRlLnNlbGVjdGVkRXhlcmNpc2V9PC9kaXY+XHJcblx0XHRcdFx0XHQ8c2VsZWN0IG9uQ2hhbmdlPXt0aGlzLmNoYW5nZUV4ZXJjaXNlfT5cclxuXHRcdFx0XHRcdFx0e2V4ZXJjaXNlT3B0aW9uc31cclxuXHRcdFx0XHRcdDwvc2VsZWN0PlxyXG5cdFx0XHRcdFx0PGJ1dHRvbiBvbkNsaWNrPXt0aGlzLmFkZEV4ZXJjaXNlfT5BZGQgZXhlcmNpc2U8L2J1dHRvbj5cclxuXHRcdFx0XHRcdHtleGVyY2lzZUZvcldvcmtvdXRMaXN0fVxyXG5cdFx0XHRcdDwvZGl2PlxyXG5cdFx0XHQpO1xyXG5cdFx0fVxyXG5cdFx0ZWxzZXtcclxuXHRcdFx0cmV0dXJuIChcclxuXHRcdFx0XHQ8aDI+TG9hZGluZy4uLjwvaDI+XHJcblx0XHRcdCk7XHJcblx0XHR9XHJcblx0fVxyXG59KTtcclxuXHJcbm1vZHVsZS5leHBvcnRzID0gV29ya291dDsiLCJ2YXIgYXV0aCA9IHJlcXVpcmUoXCIuL2F1dGhcIik7XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IHtcclxuXHRsb2c6IGZ1bmN0aW9uKHRleHQpe1xyXG5cdFx0Y29uc29sZS5sb2codGV4dCk7XHJcblx0fSxcclxuXHRnZXQ6IGZ1bmN0aW9uKHVybCwgc3VjY2Vzcyl7XHJcblx0XHQkLmFqYXgoe1xyXG5cdFx0XHR1cmw6IHVybCxcclxuXHRcdFx0dHlwZTogJ0dFVCcsXHJcblx0XHRcdGhlYWRlcnM6IHtcclxuXHRcdFx0XHRcIngtYXV0aC10b2tlblwiOiBhdXRoLmdldFRva2VuKCksXHJcblx0XHRcdFx0XCJ4LWF1dGgtdXNlcm5hbWVcIjogYXV0aC5nZXRVc2VybmFtZSgpXHJcblx0XHRcdH0sXHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3VsdCkge1xyXG5cdFx0XHRcdHN1Y2Nlc3MocmVzdWx0KTtcclxuXHRcdFx0fS5iaW5kKHRoaXMpLFxyXG5cdFx0XHRlcnJvcjogZnVuY3Rpb24oeGhyLCBzdGF0dXMsIGVycikge1xyXG5cdFx0XHRcdGNvbnNvbGUubG9nKHN0YXR1cyk7XHJcblx0XHRcdFx0aWYoeGhyLnN0YXR1cyA+PSA0MDApIHdpbmRvdy5sb2NhdGlvbi5ocmVmID0gYXV0aC5sb2dpblBhZ2U7XHJcblx0XHRcdH0uYmluZCh0aGlzKVxyXG5cdFx0fSk7XHJcblx0fSxcclxuXHRwb3N0OiBmdW5jdGlvbih1cmwsIGRhdGEsIHN1Y2Nlc3Mpe1xyXG5cdFx0JC5hamF4KHtcclxuXHRcdFx0dXJsOiB1cmwsXHJcblx0XHRcdHR5cGU6ICdQT1NUJyxcclxuXHRcdFx0ZGF0YTogZGF0YSxcclxuXHRcdFx0aGVhZGVyczoge1xyXG5cdFx0XHRcdFwieC1hdXRoLXRva2VuXCI6IGF1dGguZ2V0VG9rZW4oKSxcclxuXHRcdFx0XHRcIngtYXV0aC11c2VybmFtZVwiOiBhdXRoLmdldFVzZXJuYW1lKClcclxuXHRcdFx0fSxcclxuXHRcdFx0c3VjY2VzczogZnVuY3Rpb24ocmVzdWx0KSB7XHJcblx0XHRcdFx0c3VjY2VzcyhyZXN1bHQpO1xyXG5cdFx0XHR9LmJpbmQodGhpcyksXHJcblx0XHRcdGVycm9yOiBmdW5jdGlvbih4aHIsIHN0YXR1cywgZXJyKSB7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coc3RhdHVzKTtcclxuXHRcdFx0XHRpZih4aHIuc3RhdHVzID49IDQwMCkgd2luZG93LmxvY2F0aW9uLmhyZWYgPSBhdXRoLmxvZ2luUGFnZTtcclxuXHRcdFx0fS5iaW5kKHRoaXMpXHJcblx0XHR9KTtcclxuXHR9XHJcbn07IiwidmFyIGF1dGggPSB7XHJcblx0bG9naW5QYWdlOiBcIi9sb2dpbi5odG1sXCIsXHJcblx0bG9nb3V0OiBmdW5jdGlvbihjYWxsYmFjayl7XHJcblx0XHQkLmFqYXgoe1xyXG5cdFx0XHR1cmw6IFwiL2xvZ291dFwiLFxyXG5cdFx0XHR0eXBlOiAnUE9TVCcsXHJcblx0XHRcdGRhdGE6IHtcclxuXHRcdFx0XHR1c2VybmFtZTogdGhpcy5nZXRVc2VybmFtZSgpXHJcblx0XHRcdH0sXHJcblx0XHRcdHN1Y2Nlc3M6IGZ1bmN0aW9uKHJlc3VsdCkge1xyXG5cdFx0XHRcdGRlbGV0ZSBsb2NhbFN0b3JhZ2UudG9rZW47XHJcblx0XHRcdFx0ZGVsZXRlIGxvY2FsU3RvcmFnZS51c2VybmFtZTtcclxuXHRcdFx0XHRjYWxsYmFjaygpO1xyXG5cdFx0XHR9LmJpbmQodGhpcyksXHJcblx0XHRcdGVycm9yOiBmdW5jdGlvbih4aHIsIHN0YXR1cywgZXJyKSB7XHJcblx0XHRcdFx0Y29uc29sZS5sb2coXCJlcnJvciB3aGlsZSBsb2dnaW50IG91dFwiKTtcclxuXHRcdFx0XHRkZWxldGUgbG9jYWxTdG9yYWdlLnRva2VuO1xyXG5cdFx0XHRcdGRlbGV0ZSBsb2NhbFN0b3JhZ2UudXNlcm5hbWU7XHJcblx0XHRcdFx0Y2FsbGJhY2soKTtcclxuXHRcdFx0fS5iaW5kKHRoaXMpXHJcblx0XHR9KTtcclxuXHR9LFxyXG5cdGF1dGhvcml6ZTogZnVuY3Rpb24oY2FsbGJhY2spe1xyXG5cdFx0aWYoIXRoaXMuZ2V0VG9rZW4oKSkge1xyXG5cdFx0XHRjYWxsYmFjayhmYWxzZSk7XHJcblx0XHRcdHJldHVybjtcclxuXHRcdH1cclxuXHJcblx0XHQkLmFqYXgoe1xyXG5cdFx0XHR1cmw6IFwiL2F1dGhvcml6ZVwiLFxyXG5cdFx0XHR0eXBlOiAnR0VUJyxcclxuXHRcdFx0aGVhZGVyczoge1xyXG5cdFx0XHRcdFwieC1hdXRoLXRva2VuXCI6IHRoaXMuZ2V0VG9rZW4oKSxcclxuXHRcdFx0XHRcIngtYXV0aC11c2VybmFtZVwiOiB0aGlzLmdldFVzZXJuYW1lKClcclxuXHRcdFx0fSxcclxuXHRcdFx0c3VjY2VzczogZnVuY3Rpb24ocmVzdWx0KSB7XHJcblx0XHRcdFx0Y2FsbGJhY2sodHJ1ZSk7XHJcblx0XHRcdH0uYmluZCh0aGlzKSxcclxuXHRcdFx0ZXJyb3I6IGZ1bmN0aW9uKHhociwgc3RhdHVzLCBlcnIpIHtcclxuXHRcdFx0XHRjYWxsYmFjayhmYWxzZSk7XHJcblx0XHRcdH0uYmluZCh0aGlzKVxyXG5cdFx0fSk7XHJcblx0fSxcclxuXHRnZXRUb2tlbjogZnVuY3Rpb24oKXtcclxuXHRcdHJldHVybiBsb2NhbFN0b3JhZ2UudG9rZW47XHJcblx0fSxcclxuXHRnZXRVc2VybmFtZTogZnVuY3Rpb24oKXtcclxuXHRcdHJldHVybiBsb2NhbFN0b3JhZ2UudXNlcm5hbWU7XHJcblx0fSxcclxuXHRsb2dnZWRJbjogZnVuY3Rpb24oKXtcclxuXHRcdHJldHVybiB0aGlzLmdldFRva2VuKCk7XHJcblx0fSxcclxuXHRvbkNoYW5nZTogZnVuY3Rpb24oKXt9XHJcbn07XHJcblxyXG5tb2R1bGUuZXhwb3J0cyA9IGF1dGg7Il19
